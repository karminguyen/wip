<!-- An implementation of test grouping. -->

<html>
<head>
	<title>Test Suite</title>
	<script src="../lib/jquery.js"></script>
	<script src="../lib/basic.js"></script>
	<script>
	(function(){

	<!-- Unit test functions  -->

	var results;
	
	this.assert = function assert( value, desc ) {
		var li = document.createElement("li");
		li.className = value ? "pass" : "fail";
		li.appendChild( document.createTextNode( desc ) );
		results.appendChild( li );
		if ( !value ) {
			li.parentNode.parentNode.className = "fail";
		}
		return li;
	};
	
	this.test = function test(name, fn) {
		results = document.getElementById("results");
		results = assert( true, name ).appendChild(
			document.createElement("ul") );
		fn();
	};
	
	<!-- DOM Manipulation  -->
	var tags = /^(abbr|br|col|img|input|link|meta|param|hr|area|embed)$/i;
		this.convert = function convert(html) {		return html.replace(/(<(\w+)[^>]*?)\/>/g, function (all, front, tag) {		         return tags.test(tag) ?		             all :		             front + "></" + tag + ">";		     }); 
	}
	
	this.getNodes = function getNodes(htmlString) { 
		var map = {			"<td":[3, "<table><tbody><tr>", "</tr></tbody></table>"],			"<option":[1, "<select multiple='multiple'>", "</select>"] 
			// a full list of all element fixes		
		};
			
		var name = htmlString.match(/<\w+/),			node = name ? map[ name[0] ] : [0, "", ""];
				var div = document.createElement("div"); 
		div.innerHTML = node[1] + htmlString + node[2];
		
		while (node[0]--)         div = div.lastChild;      
		return div.childNodes;
     }

	})();
	
	<!-- Run the unit tests when the browser is ready  -->
	window.onload = function(){
		test("Testing log function. Check the result checking the console of the browser", function(){
			assert( true, "Always true" );
			
			log("Logging works...");
		});

		test("DOM manipulation: convert", function(){
			assert(convert("<a/>") === "<a></a>", "Check anchor conversion."); 
			assert(convert("<hr/>") === "<hr/>", "Check hr conversion.");
		});
		
		test("DOM manipulation: getNode", function(){
			assert(getNodes("<td>test</td><td>test2</td>").length === 2, "Get two nodes back from the method.");			assert(getNodes("<td>test</td>")[0].nodeName === "TD", "Verify that we're getting the right node.");
		});

		
	};
	
	<!-- Manage some events -->
	$(function () {
		$('#dom2').on('click', function() {
			log('Testing to log');	
		});
	});

	</script>
	<style>
		#results li.pass { color: green; }
		#results li.fail { color: red; }
	</style>
</head>
<body>
	<ul id="results"></ul>
	
	<button id="dom2"></button>
	<div id="dom2"></div>
	
</body>
</html>